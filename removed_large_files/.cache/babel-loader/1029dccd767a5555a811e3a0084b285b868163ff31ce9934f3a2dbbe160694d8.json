{"ast":null,"code":"var _jsxFileName = \"/Users/alice/Desktop/library-app/03-frontend/react-library/src/layouts/ManageLibraryPage/components/AdminMessages.tsx\",\n  _s = $RefreshSig$();\nimport { useOktaAuth } from '@okta/okta-react';\nimport { useEffect, useState } from 'react';\nimport AdminMessageRequest from '../../../models/AdminMessageRequest';\nimport { Pagination } from '../../Utils/Pagination';\nimport { SpinnerLoading } from '../../Utils/SpinnerLoading';\nimport { AdminMessage } from './AdminMessage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const AdminMessages = () => {\n  _s();\n  const {\n    authState\n  } = useOktaAuth();\n\n  // Normal Loading Pieces\n  const [isLoadingMessages, setIsLoadingMessages] = useState(true);\n  const [httpError, setHttpError] = useState(null);\n\n  // Messages endpoint State\n  const [messages, setMessages] = useState([]);\n  const [messagesPerPage] = useState(5);\n\n  // Pagination\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(0);\n\n  // Recall useEffect\n  const [btnSubmit, setBtnSubmit] = useState(false);\n  useEffect(() => {\n    const fetchUserMessages = async () => {\n      if (authState && authState.isAuthenticated) {\n        var _authState$accessToke;\n        const url = `http://localhost:8080/api/messages/search/findByClosed/?closed=false&page=${currentPage - 1}&size=${messagesPerPage}`;\n        const requestOptions = {\n          method: 'GET',\n          headers: {\n            Authorization: `Bearer ${(_authState$accessToke = authState.accessToken) === null || _authState$accessToke === void 0 ? void 0 : _authState$accessToke.accessToken}`,\n            'Content-Type': 'application/json'\n          }\n        };\n        const messagesResponse = await fetch(url, requestOptions);\n        if (!messagesResponse.ok) {\n          throw new Error('Something went wrong!');\n        }\n        const messagesResponseJson = await messagesResponse.json();\n        setMessages(messagesResponseJson._embedded.messages);\n        setTotalPages(messagesResponseJson.page.totalPages);\n      }\n      setIsLoadingMessages(false);\n    };\n    fetchUserMessages().catch(error => {\n      setIsLoadingMessages(false);\n      setHttpError(error.message);\n    });\n    window.scrollTo(0, 0);\n  }, [authState, currentPage, btnSubmit]);\n  if (isLoadingMessages) {\n    return /*#__PURE__*/_jsxDEV(SpinnerLoading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }, this);\n  }\n  if (httpError) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container m-5\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: httpError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this);\n  }\n  async function submitResponseToQuestion(id, response) {\n    const url = `http://localhost:8080/api/messages/secure/admin/message`;\n    if (authState && authState !== null && authState !== void 0 && authState.isAuthenticated && id !== null && response !== '') {\n      var _authState$accessToke2;\n      const messageAdminRequestModel = new AdminMessageRequest(id, response);\n      const requestOptions = {\n        method: 'PUT',\n        headers: {\n          Authorization: `Bearer ${authState === null || authState === void 0 ? void 0 : (_authState$accessToke2 = authState.accessToken) === null || _authState$accessToke2 === void 0 ? void 0 : _authState$accessToke2.accessToken}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(messageAdminRequestModel)\n      };\n      const messageAdminRequestModelResponse = await fetch(url, requestOptions);\n      if (!messageAdminRequestModelResponse.ok) {\n        throw new Error('Something went wrong!');\n      }\n      setBtnSubmit(!btnSubmit);\n    }\n  }\n  const paginate = pageNumber => setCurrentPage(pageNumber);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mt-3\",\n    children: [messages.length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n        children: \"Pending Q/A: \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 21\n      }, this), messages.map(message => /*#__PURE__*/_jsxDEV(AdminMessage, {\n        message: message,\n        submitResponseToQuestion: submitResponseToQuestion\n      }, message.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 25\n      }, this))]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(\"h5\", {\n      children: \"No pending Q/A\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }, this), totalPages > 1 && /*#__PURE__*/_jsxDEV(Pagination, {\n      currentPage: currentPage,\n      totalPages: totalPages,\n      paginate: paginate\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 32\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 9\n  }, this);\n};\n_s(AdminMessages, \"CWbHRqx0Y6Fx+yJrHEpbXsDI+kM=\", false, function () {\n  return [useOktaAuth];\n});\n_c = AdminMessages;\nvar _c;\n$RefreshReg$(_c, \"AdminMessages\");","map":{"version":3,"names":["useOktaAuth","useEffect","useState","AdminMessageRequest","Pagination","SpinnerLoading","AdminMessage","jsxDEV","_jsxDEV","Fragment","_Fragment","AdminMessages","_s","authState","isLoadingMessages","setIsLoadingMessages","httpError","setHttpError","messages","setMessages","messagesPerPage","currentPage","setCurrentPage","totalPages","setTotalPages","btnSubmit","setBtnSubmit","fetchUserMessages","isAuthenticated","_authState$accessToke","url","requestOptions","method","headers","Authorization","accessToken","messagesResponse","fetch","ok","Error","messagesResponseJson","json","_embedded","page","catch","error","message","window","scrollTo","fileName","_jsxFileName","lineNumber","columnNumber","className","children","submitResponseToQuestion","id","response","_authState$accessToke2","messageAdminRequestModel","body","JSON","stringify","messageAdminRequestModelResponse","paginate","pageNumber","length","map","_c","$RefreshReg$"],"sources":["/Users/alice/Desktop/library-app/03-frontend/react-library/src/layouts/ManageLibraryPage/components/AdminMessages.tsx"],"sourcesContent":["import { useOktaAuth } from '@okta/okta-react';\nimport { useEffect, useState } from 'react';\nimport AdminMessageRequest from '../../../models/AdminMessageRequest';\nimport MessageModel from '../../../models/MessageModel';\nimport { Pagination } from '../../Utils/Pagination';\nimport { SpinnerLoading } from '../../Utils/SpinnerLoading';\nimport { AdminMessage } from './AdminMessage';\n\nexport const AdminMessages = () => {\n    \n    const { authState } = useOktaAuth();\n\n    // Normal Loading Pieces\n    const [isLoadingMessages, setIsLoadingMessages] = useState(true);\n    const [httpError, setHttpError] = useState(null);\n    \n    // Messages endpoint State\n    const [messages, setMessages] = useState<MessageModel[]>([]);\n    const [messagesPerPage] = useState(5);\n\n    // Pagination\n    const [currentPage, setCurrentPage] = useState(1);\n    const [totalPages, setTotalPages] = useState(0);\n\n    // Recall useEffect\n    const [btnSubmit, setBtnSubmit] = useState(false);\n\n    useEffect(() => {\n        const fetchUserMessages = async () => {\n            if (authState && authState.isAuthenticated) {\n                const url = `http://localhost:8080/api/messages/search/findByClosed/?closed=false&page=${currentPage - 1}&size=${messagesPerPage}`;\n                const requestOptions = {\n                    method: 'GET',\n                    headers: {\n                        Authorization: `Bearer ${authState.accessToken?.accessToken}`,\n                        'Content-Type': 'application/json'\n                    }\n                };\n                const messagesResponse = await fetch(url, requestOptions);\n                if (!messagesResponse.ok) {\n                    throw new Error('Something went wrong!');\n                }\n                const messagesResponseJson = await messagesResponse.json();\n\n                setMessages(messagesResponseJson._embedded.messages);\n                setTotalPages(messagesResponseJson.page.totalPages);\n            }\n            setIsLoadingMessages(false);\n        }\n        fetchUserMessages().catch((error: any) => {\n            setIsLoadingMessages(false);\n            setHttpError(error.message);\n        })\n        window.scrollTo(0, 0);\n    }, [authState, currentPage, btnSubmit]);\n\n    if (isLoadingMessages) {\n        return (\n            <SpinnerLoading/>\n        );\n    }\n\n    if (httpError) {\n        return (\n            <div className='container m-5'>\n                <p>{httpError}</p>\n            </div>\n        );\n    }\n\n\n    async function submitResponseToQuestion(id: number, response: string) {\n        const url = `http://localhost:8080/api/messages/secure/admin/message`;\n        if (authState && authState?.isAuthenticated && id !== null && response !== '') {\n            const messageAdminRequestModel: AdminMessageRequest = new AdminMessageRequest(id, response);\n            const requestOptions = {\n                method: 'PUT',\n                headers: {\n                    Authorization: `Bearer ${authState?.accessToken?.accessToken}`,\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(messageAdminRequestModel)\n            };\n\n            const messageAdminRequestModelResponse = await fetch(url, requestOptions);\n            if (!messageAdminRequestModelResponse.ok) {\n                throw new Error('Something went wrong!');\n            }\n            setBtnSubmit(!btnSubmit);\n        }\n    }\n\n    const paginate = (pageNumber: number) => setCurrentPage(pageNumber);\n\n    return (\n        <div className='mt-3'>\n            {messages.length > 0 ? \n                <>\n                    <h5>Pending Q/A: </h5>\n                    {messages.map(message => (\n                        <AdminMessage message={message} key={message.id} submitResponseToQuestion={submitResponseToQuestion}/>\n                    ))}\n                </>\n                :\n                <h5>No pending Q/A</h5>\n            }\n            {totalPages > 1 && <Pagination currentPage={currentPage} totalPages={totalPages} paginate={paginate}/>}\n        </div>\n    );\n}"],"mappings":";;AAAA,SAASA,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,OAAOC,mBAAmB,MAAM,qCAAqC;AAErE,SAASC,UAAU,QAAQ,wBAAwB;AACnD,SAASC,cAAc,QAAQ,4BAA4B;AAC3D,SAASC,YAAY,QAAQ,gBAAgB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAE9C,OAAO,MAAMC,aAAa,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAE/B,MAAM;IAAEC;EAAU,CAAC,GAAGb,WAAW,CAAC,CAAC;;EAEnC;EACA,MAAM,CAACc,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EAChE,MAAM,CAACc,SAAS,EAAEC,YAAY,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;;EAEhD;EACA,MAAM,CAACgB,QAAQ,EAAEC,WAAW,CAAC,GAAGjB,QAAQ,CAAiB,EAAE,CAAC;EAC5D,MAAM,CAACkB,eAAe,CAAC,GAAGlB,QAAQ,CAAC,CAAC,CAAC;;EAErC;EACA,MAAM,CAACmB,WAAW,EAAEC,cAAc,CAAC,GAAGpB,QAAQ,CAAC,CAAC,CAAC;EACjD,MAAM,CAACqB,UAAU,EAAEC,aAAa,CAAC,GAAGtB,QAAQ,CAAC,CAAC,CAAC;;EAE/C;EACA,MAAM,CAACuB,SAAS,EAAEC,YAAY,CAAC,GAAGxB,QAAQ,CAAC,KAAK,CAAC;EAEjDD,SAAS,CAAC,MAAM;IACZ,MAAM0B,iBAAiB,GAAG,MAAAA,CAAA,KAAY;MAClC,IAAId,SAAS,IAAIA,SAAS,CAACe,eAAe,EAAE;QAAA,IAAAC,qBAAA;QACxC,MAAMC,GAAG,GAAI,6EAA4ET,WAAW,GAAG,CAAE,SAAQD,eAAgB,EAAC;QAClI,MAAMW,cAAc,GAAG;UACnBC,MAAM,EAAE,KAAK;UACbC,OAAO,EAAE;YACLC,aAAa,EAAG,UAAO,CAAAL,qBAAA,GAAEhB,SAAS,CAACsB,WAAW,cAAAN,qBAAA,uBAArBA,qBAAA,CAAuBM,WAAY,EAAC;YAC7D,cAAc,EAAE;UACpB;QACJ,CAAC;QACD,MAAMC,gBAAgB,GAAG,MAAMC,KAAK,CAACP,GAAG,EAAEC,cAAc,CAAC;QACzD,IAAI,CAACK,gBAAgB,CAACE,EAAE,EAAE;UACtB,MAAM,IAAIC,KAAK,CAAC,uBAAuB,CAAC;QAC5C;QACA,MAAMC,oBAAoB,GAAG,MAAMJ,gBAAgB,CAACK,IAAI,CAAC,CAAC;QAE1DtB,WAAW,CAACqB,oBAAoB,CAACE,SAAS,CAACxB,QAAQ,CAAC;QACpDM,aAAa,CAACgB,oBAAoB,CAACG,IAAI,CAACpB,UAAU,CAAC;MACvD;MACAR,oBAAoB,CAAC,KAAK,CAAC;IAC/B,CAAC;IACDY,iBAAiB,CAAC,CAAC,CAACiB,KAAK,CAAEC,KAAU,IAAK;MACtC9B,oBAAoB,CAAC,KAAK,CAAC;MAC3BE,YAAY,CAAC4B,KAAK,CAACC,OAAO,CAAC;IAC/B,CAAC,CAAC;IACFC,MAAM,CAACC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;EACzB,CAAC,EAAE,CAACnC,SAAS,EAAEQ,WAAW,EAAEI,SAAS,CAAC,CAAC;EAEvC,IAAIX,iBAAiB,EAAE;IACnB,oBACIN,OAAA,CAACH,cAAc;MAAA4C,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAC,CAAC;EAEzB;EAEA,IAAIpC,SAAS,EAAE;IACX,oBACIR,OAAA;MAAK6C,SAAS,EAAC,eAAe;MAAAC,QAAA,eAC1B9C,OAAA;QAAA8C,QAAA,EAAItC;MAAS;QAAAiC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACjB,CAAC;EAEd;EAGA,eAAeG,wBAAwBA,CAACC,EAAU,EAAEC,QAAgB,EAAE;IAClE,MAAM3B,GAAG,GAAI,yDAAwD;IACrE,IAAIjB,SAAS,IAAIA,SAAS,aAATA,SAAS,eAATA,SAAS,CAAEe,eAAe,IAAI4B,EAAE,KAAK,IAAI,IAAIC,QAAQ,KAAK,EAAE,EAAE;MAAA,IAAAC,sBAAA;MAC3E,MAAMC,wBAA6C,GAAG,IAAIxD,mBAAmB,CAACqD,EAAE,EAAEC,QAAQ,CAAC;MAC3F,MAAM1B,cAAc,GAAG;QACnBC,MAAM,EAAE,KAAK;QACbC,OAAO,EAAE;UACLC,aAAa,EAAG,UAASrB,SAAS,aAATA,SAAS,wBAAA6C,sBAAA,GAAT7C,SAAS,CAAEsB,WAAW,cAAAuB,sBAAA,uBAAtBA,sBAAA,CAAwBvB,WAAY,EAAC;UAC9D,cAAc,EAAE;QACpB,CAAC;QACDyB,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACH,wBAAwB;MACjD,CAAC;MAED,MAAMI,gCAAgC,GAAG,MAAM1B,KAAK,CAACP,GAAG,EAAEC,cAAc,CAAC;MACzE,IAAI,CAACgC,gCAAgC,CAACzB,EAAE,EAAE;QACtC,MAAM,IAAIC,KAAK,CAAC,uBAAuB,CAAC;MAC5C;MACAb,YAAY,CAAC,CAACD,SAAS,CAAC;IAC5B;EACJ;EAEA,MAAMuC,QAAQ,GAAIC,UAAkB,IAAK3C,cAAc,CAAC2C,UAAU,CAAC;EAEnE,oBACIzD,OAAA;IAAK6C,SAAS,EAAC,MAAM;IAAAC,QAAA,GAChBpC,QAAQ,CAACgD,MAAM,GAAG,CAAC,gBAChB1D,OAAA,CAAAE,SAAA;MAAA4C,QAAA,gBACI9C,OAAA;QAAA8C,QAAA,EAAI;MAAa;QAAAL,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,EACrBlC,QAAQ,CAACiD,GAAG,CAACrB,OAAO,iBACjBtC,OAAA,CAACF,YAAY;QAACwC,OAAO,EAAEA,OAAQ;QAAkBS,wBAAwB,EAAEA;MAAyB,GAA/DT,OAAO,CAACU,EAAE;QAAAP,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAsD,CACxG,CAAC;IAAA,eACJ,CAAC,gBAEH5C,OAAA;MAAA8C,QAAA,EAAI;IAAc;MAAAL,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EAE1B7B,UAAU,GAAG,CAAC,iBAAIf,OAAA,CAACJ,UAAU;MAACiB,WAAW,EAAEA,WAAY;MAACE,UAAU,EAAEA,UAAW;MAACyC,QAAQ,EAAEA;IAAS;MAAAf,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACrG,CAAC;AAEd,CAAC;AAAAxC,EAAA,CArGYD,aAAa;EAAA,QAEAX,WAAW;AAAA;AAAAoE,EAAA,GAFxBzD,aAAa;AAAA,IAAAyD,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}